syntax = "proto3";
// import "google/protobuf/empty.proto";

package auth;

service AuthService {
  rpc Login (LoginDto) returns (LoginResponse) {}
  rpc RefreshToken (RefreshTokenDto) returns (LoginResponse) {}
  rpc Register (RegisterDto) returns (RegisterResponse) {}
  rpc LoginGoogle (LoginGoogleDto) returns (LoginResponse) {}
  rpc LoginApple (LoginAppleDto) returns (LoginResponse) {}
  rpc ForgotPassword (ForgotPasswordDto) returns (MessageResponse) {}
  rpc ValidateToken (ValidateTokenDto) returns (ValidateTokenResponse) {}
  rpc ResetPassword (ResetPasswordDto) returns (MessageResponse) {}
  rpc ChangePassword (ChangePasswordDto) returns (MessageResponse) {}
  rpc SendEmailOtp (SendEmailOtpDto) returns (MessageResponse) {}
  rpc SendSmsOtp (SendSmsOtpDto) returns (MessageResponse) {}
  rpc ValidateEmailOtp (ValidateEmailOtpDto) returns (ValidateOtpResponse) {}
  rpc ValidateSmsOtp (ValidateSmsOtpDto) returns (ValidateOtpResponse) {}
  rpc GetVendorProfile (GetVendorProfileDto) returns (VendorProfileResponse) {}
  rpc UpdateVendorProfile (UpdateVendorProfileDto) returns (VendorProfileResponse) {}
  rpc InitiateVendorVerification (InitiateVerificationDto) returns (InitiateVerificationResponse) {}
  rpc SubmitVendorVerification (SubmitVerificationDto) returns (SubmitVerificationResponse) {}
  rpc GetVendorVerificationStatus (GetVerificationStatusDto) returns (GetVerificationStatusResponse) {}
  rpc AdminReviewVendorVerification (AdminReviewVerificationDto) returns (AdminReviewVerificationResponse) {}
  rpc SearchVendorsByLocation (SearchVendorsByLocationDto) returns (SearchVendorsByLocationResponse) {}
}

// Request DTOs
message LoginDto {
  string email = 1;
  string password = 2;
}

message RefreshTokenDto {
  string userId = 1;
  string refreshToken = 2;
}

message RegisterDto {
  string email = 1;
  string password = 2;
  string firstName = 3;
  string lastName = 4;
  bool agreeToTerms = 5;
  string phoneNumber = 6;
  optional string source = 7;
}

message LoginGoogleDto {
  string accessToken = 1;
  string refreshToken = 2;
}

message LoginAppleDto {
  string code = 1;
}

message ForgotPasswordDto {
  string email = 1;
}

message ValidateTokenDto {
  string token = 1;
  string email = 2;
}

message ResetPasswordDto {
  string token = 1;
  string email = 2;
  string newPassword = 3;
}

message ChangePasswordDto {
  string currentPassword = 1;
  string newPassword = 2;
}

message SendEmailOtpDto {
  string email = 1;
}

message SendSmsOtpDto {
  string phoneNumber = 1;
}

message ValidateEmailOtpDto {
  string email = 1;
  string token = 2;
}

message ValidateSmsOtpDto {
  string phoneNumber = 1;
  string token = 2;
}

// Shared/Common Messages
message UserDto {
  string id = 1;
  string firstName = 2;
  string lastName = 3;
  string email = 4;
  string phoneNumber = 5;
  string userType = 6;
  bool isEmailVerified = 7;
  bool isPhoneVerified = 8;
  optional string source = 9;
}

message MessageResponse {
  string message = 1;
  int32 statusCode = 2;
  bool success = 3;
}

// Response Messages
message LoginResponse {
  message Credentials {
    string accessToken = 1;
    string refreshToken = 2;
  }

  optional Credentials credentials = 1;
  string message = 2;
  int32 statusCode = 3;
  bool success = 4;
  UserDto user = 5;
}

message RegisterResponse {
  string message = 1;
  int32 statusCode = 2;
  bool success = 3;
  UserDto user = 4;
}

message ValidateTokenResponse {
  string message = 1;
  int32 statusCode = 2;
  bool success = 3;
  bool isValid = 4;
}

message ValidateOtpResponse {
  message Credentials {
    string accessToken = 1;
    string refreshToken = 2;
  }

  optional Credentials credentials = 1;
  string message = 2;
  int32 statusCode = 3;
  bool success = 4;
  bool isValid = 5;
  UserDto user = 6;
}

message BusinessHoursInput{
  string dayOfWeek = 1;
  bool isOpen = 2;
  string openTime = 3;
  string closeTime = 4;
  string openTime2 = 5;
  string closeTime2 = 6;
}

message BusinessHoursDto {
  string id = 1;
  string dayOfWeek = 2;
  bool isOpen = 3;
  string openTime = 4;
  string closeTime = 5;
  string openTime2 = 6;
  string closeTime2 = 7;
}

message VendorProfileDto {
  string id = 1;
  string userId = 2;
  string businessName = 3;
  string businessType = 4;
  string address = 5;
  string coverImageUrl = 6;
  string description = 7;
  repeated string serviceTypes = 8;
  bool isProfileComplete = 9;
  bool isThirdPartyVerified = 10;
  bool isKycVerified = 11;
  int32 verificationStep = 12;
  repeated BusinessHoursDto businessHours = 13;
  string createdAt = 14;
  string updatedAt = 15;
  double latitude = 16;
  double longitude = 17;
}

message GetVendorProfileDto {
  string userId = 1;
}

message UpdateVendorProfileDto {
  string userId = 1;
  string businessName = 2;
  string businessType = 3;
  string address = 4;
  string coverImageUrl = 5;
  string description = 6;
  repeated string serviceTypes = 7;
  repeated BusinessHoursInput businessHours = 8;
  int32 verificationStep = 9;
   double latitude = 10;
  double longitude = 11;
}

message VendorProfileResponse {
  string message = 1;
  int32 statusCode = 2;
  bool success = 3;
  VendorProfileDto profile = 4;
}

message InitiateVerificationDto {
  string userId = 1;
}

message InitiateVerificationResponse {
  string message = 1;
  int32 statusCode = 2;
  bool success = 3;
  string token = 4;
  string jobId = 5;
}

message SubmitVerificationDto {
  string userId = 1;
  string documentType = 2;
  string documentNumber = 3;
  string dateOfBirth = 4;
  string selfieImageBase64 = 5;
  string documentImageBase64 = 6;
  string selfieImageUrl = 7;
  string documentImageUrl = 8;
}

message SubmitVerificationResponse {
  string message = 1;
  int32 statusCode = 2;
  bool success = 3;
  string verificationId = 4;
}

message GetVerificationStatusDto {
  string userId = 1;
}

message VerificationDto {
  string id = 1;
  string verificationType = 2;
  string status = 3;
  string documentType = 4;
  string smileResultText = 5;
  string reviewNotes = 6;
  string rejectionReason = 7;
  string createdAt = 8;
  string reviewedAt = 9;
}

message GetVerificationStatusResponse {
  string message = 1;
  int32 statusCode = 2;
  bool success = 3;
  bool isThirdPartyVerified = 4;
  bool isKycVerified = 5;
  repeated VerificationDto verifications = 6;
}

message AdminReviewVerificationDto {
  string verificationId = 1;
  string adminUserId = 2;
  bool approved = 3;
  string reviewNotes = 4;
  string rejectionReason = 5;
}

message AdminReviewVerificationResponse {
  string message = 1;
  int32 statusCode = 2;
  bool success = 3;
}

message SearchVendorsByLocationDto {
  double latitude = 1;
  double longitude = 2;
  double radiusKm = 3;
  string industry = 4;
  int32 limit = 5;
  int32 offset = 6;
}

message VendorDistanceDto {
  string id = 1;
  string userId = 2;
  string businessName = 3;
  string businessType = 4;
  string address = 5;
  double latitude = 6;
  double longitude = 7;
  string coverImageUrl = 8;
  string description = 9;
  repeated string serviceTypes = 10;
  bool isProfileComplete = 11;
  bool isThirdPartyVerified = 12;
  bool isKycVerified = 13;
  int32 verificationStep = 14;
  double distanceKm = 15;
  string createdAt = 16;
  string updatedAt = 17;
}

message SearchVendorsByLocationResponse {
  string message = 1;
  int32 statusCode = 2;
  bool success = 3;
  repeated VendorDistanceDto vendors = 4;
  int32 total = 5;
}
