syntax = "proto3";
// import "google/protobuf/empty.proto";

package auth;

service AuthService {
  rpc Login (LoginDto) returns (LoginResponse) {}
  rpc RefreshToken (RefreshTokenDto) returns (LoginResponse) {}
  rpc Register (RegisterDto) returns (RegisterResponse) {}
  rpc LoginGoogle (LoginGoogleDto) returns (LoginResponse) {}
  rpc LoginApple (LoginAppleDto) returns (LoginResponse) {}
  rpc ForgotPassword (ForgotPasswordDto) returns (MessageResponse) {}
  rpc ValidateToken (ValidateTokenDto) returns (ValidateTokenResponse) {}
  rpc ResetPassword (ResetPasswordDto) returns (MessageResponse) {}
  rpc ChangePassword (ChangePasswordDto) returns (MessageResponse) {}
  rpc SendEmailOtp (SendEmailOtpDto) returns (MessageResponse) {}
  rpc SendSmsOtp (SendSmsOtpDto) returns (MessageResponse) {}
  rpc ValidateEmailOtp (ValidateEmailOtpDto) returns (ValidateOtpResponse) {}
  rpc ValidateSmsOtp (ValidateSmsOtpDto) returns (ValidateOtpResponse) {}
}

// Request DTOs
message LoginDto {
  string email = 1;
  string password = 2;
}

message RefreshTokenDto {
  string userId = 1;
  string refreshToken = 2;
}

message RegisterDto {
  string email = 1;
  string password = 2;
  string firstName = 3;
  string lastName = 4;
  bool agreeToTerms = 5;
  string phoneNumber = 6;
  optional string source = 7;
}

message LoginGoogleDto {
  string accessToken = 1;
  string refreshToken = 2;
}

message LoginAppleDto {
  string code = 1;
}

message ForgotPasswordDto {
  string email = 1;
}

message ValidateTokenDto {
  string token = 1;
  string email = 2;
}

message ResetPasswordDto {
  string token = 1;
  string email = 2;
  string newPassword = 3;
}

message ChangePasswordDto {
  string currentPassword = 1;
  string newPassword = 2;
}

message SendEmailOtpDto {
  string email = 1;
}

message SendSmsOtpDto {
  string phoneNumber = 1;
}

message ValidateEmailOtpDto {
  string email = 1;
  string token = 2;
}

message ValidateSmsOtpDto {
  string phoneNumber = 1;
  string token = 2;
}

// Shared/Common Messages
message UserDto {
  string id = 1;
  string firstName = 2;
  string lastName = 3;
  string email = 4;
  string phoneNumber = 5;
  string userType = 6;
  bool isEmailVerified = 7;
  bool isPhoneVerified = 8;
  optional string source = 9;
}

message MessageResponse {
  string message = 1;
  int32 statusCode = 2;
  bool success = 3;
}

// Response Messages
message LoginResponse {
  message Credentials {
    string accessToken = 1;
    string refreshToken = 2;
  }

  optional Credentials credentials = 1;
  string message = 2;
  int32 statusCode = 3;
  bool success = 4;
  UserDto user = 5;
}

message RegisterResponse {
  string message = 1;
  int32 statusCode = 2;
  bool success = 3;
  UserDto user = 4;
}

message ValidateTokenResponse {
  string message = 1;
  int32 statusCode = 2;
  bool success = 3;
  bool isValid = 4;
}

message ValidateOtpResponse {
  message Credentials {
    string accessToken = 1;
    string refreshToken = 2;
  }

  optional Credentials credentials = 1;
  string message = 2;
  int32 statusCode = 3;
  bool success = 4;
  bool isValid = 5;
  UserDto user = 6;
}
